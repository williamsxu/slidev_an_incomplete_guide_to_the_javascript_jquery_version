import {
  generateComponentFromPath,
  isIconPath,
  normalizeIconPath
} from "./chunk-G56EZ2RR.mjs";
import {
  __require
} from "./chunk-V3LEQVIA.mjs";

// src/index.ts
import { createUnplugin } from "unplugin";

// src/core/options.ts
import hasPkg from "has-pkg";
function resolveOptions(options) {
  const {
    scale = 1.2,
    defaultStyle = "",
    defaultClass = "",
    compiler = guessCompiler(),
    jsx = guessJSX(),
    customCollections = {}
  } = options;
  const webComponents = Object.assign({
    autoDefine: false,
    iconPrefix: "icon"
  }, options.webComponents);
  return {
    scale,
    defaultStyle,
    defaultClass,
    customCollections,
    compiler,
    jsx,
    webComponents
  };
}
function guessCompiler() {
  return getVueVersion() || (hasPkg("@svgr/core") ? "jsx" : "vue3");
}
function guessJSX() {
  if (hasPkg("preact"))
    return "preact";
  return "react";
}
function getVueVersion() {
  var _a;
  try {
    const vue = __require("vue");
    const version = ((_a = vue == null ? void 0 : vue.default) == null ? void 0 : _a.version) || (vue == null ? void 0 : vue.version) || "3";
    return version.startsWith("2.") ? "vue2" : "vue3";
  } catch {
    return null;
  }
}

// src/index.ts
var unplugin = createUnplugin((options = {}) => {
  const resolved = resolveOptions(options);
  return {
    name: "unplugin-icons",
    enforce: "pre",
    resolveId(id) {
      if (isIconPath(id)) {
        const res = normalizeIconPath(id).replace(/\.\w+$/i, "").replace(/^\//, "");
        const ext = options.compiler === "jsx" ? ".jsx" : options.compiler === "svelte" ? ".svelte" : "";
        return res + ext;
      }
      return null;
    },
    async load(id) {
      if (isIconPath(id)) {
        const code = await generateComponentFromPath(id, resolved) || null;
        if (code)
          return { code, map: { mappings: "" } };
      }
      return null;
    }
  };
});
var src_default = unplugin;

export {
  src_default
};
